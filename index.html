<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>Kontrol Pendingin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: sans-serif;
      margin: 20px;
      background: #f7f9fc;
      text-align: center;
    }
    h1 {
      color: #34495e;
    }
    .mode {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }
    button {
      padding: 15px 25px;
      font-size: 18px;
      border-radius: 10px;
      border: none;
      cursor: pointer;
    }
    .on {
      background-color: #27ae60;
      color: white;
    }
    .off {
      background-color: #e74c3c;
      color: white;
    }
    #suhu {
      font-size: 24px;
      margin-top: 30px;
    }
  </style>
</head>
<body>

<h1>Sistem Pendingin</h1>
<div class="mode">
  <button id="mode15" class="off">Mode 15째C</button>
  <button id="mode20" class="off">Mode 20째C</button>
</div>
<div id="suhu">Suhu: -- 째C</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>

<script>
  const firebaseConfig = {
    apiKey: "AIzaSyAFHeWf7DeuUkF9ex3LB3a2gQVCFFgZ-cg",
    authDomain: "sistem-pendingin.firebaseapp.com",
    databaseURL: "https://sistem-pendingin-default-rtdb.firebaseio.com",
    projectId: "sistem-pendingin",
    storageBucket: "sistem-pendingin.firebasestorage.app",
    messagingSenderId: "127904975797",
    appId: "1:127904975797:web:b9e73aee0006e3d28ca7fc",
  };

  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Login anonim agar bisa akses tulis
  firebase.auth().signInAnonymously()
    .then(() => {
      console.log("Berhasil login anonim");
    })
    .catch(error => {
      alert("Gagal login anonim: " + error.message);
    });

  const btn15 = document.getElementById("mode15");
  const btn20 = document.getElementById("mode20");
  const suhuDiv = document.getElementById("suhu");

  btn15.onclick = () => {
    db.ref("DATA").update({ mode_15: "ON", mode_20: "OFF" });
    btn15.className = "on";
    btn20.className = "off";
  };

  btn20.onclick = () => {
    db.ref("DATA").update({ mode_15: "OFF", mode_20: "ON" });
    btn15.className = "off";
    btn20.className = "on";
  };

  db.ref("DATA/suhu").on("value", snapshot => {
    suhuDiv.innerText = "Suhu: " + snapshot.val() + " 째C";
  });

  db.ref("DATA").on("value", snap => {
    const data = snap.val() || {};
    btn15.className = data.mode_15 === "ON" ? "on" : "off";
    btn20.className = data.mode_20 === "ON" ? "on" : "off";
  });
</script>

</body>
</html>
